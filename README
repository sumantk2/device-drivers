This notes is according to my understanding after looking into the code.
